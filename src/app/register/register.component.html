<div class="col-md-6 col-md-offset-3">
    <h2>{{ 'register.title' | translate }}</h2>
    <form *ngIf="user" name="form" (ngSubmit)="f.form.valid && register()" #f="ngForm" novalidate>
      <div *ngIf="user._id">
        <h4>
          {{ user.email }}
        </h4>
      </div>
        <div class="form-group" [ngClass]="{ 'has-error': f.submitted && !firstName.valid }">
            <label for="firstName">{{ 'register.lbl.firstName' | translate }}</label>
            <input type="text" class="form-control" name="firstName" [(ngModel)]="user.profile.firstName" #firstName="ngModel" required autocomplete="on">
            <div *ngIf="f.submitted && !firstName.valid" class="help-block">{{ 'register.msg.firstNameRequired' | translate }}</div>
        </div>
        <div class="form-group" [ngClass]="{ 'has-error': f.submitted && !lastName.valid }">
            <label for="lastName">{{ 'register.lbl.lastName' | translate }}</label>
            <input type="text" class="form-control" name="lastName" [(ngModel)]="user.profile.lastName" #lastName="ngModel" required autocomplete="on">
            <div *ngIf="f.submitted && !lastName.valid" class="help-block">{{ 'register.msg.lastNameRequired' | translate }}</div>
        </div>
        <div class="form-group">
            <label for="company">{{ 'register.lbl.company' | translate }}</label>
            <input type="text" class="form-control" name="company" [(ngModel)]="user.profile.company" #company="ngModel" required autocomplete="on">
            <div *ngIf="f.submitted && !company.valid" class="help-block">{{ 'register.msg.companyRequired' | translate }}</div>
        </div>
        <div class="form-group">
            <label for="phone">{{ 'register.lbl.phone' | translate }}</label>
            <input type="text" class="form-control" name="phone" [(ngModel)]="user.profile.phone" #phone="ngModel">
        </div>
        <div *ngIf="!user._id">
          <div class="form-group" [ngClass]="{ 'has-error': f.submitted && !username.valid }">
            <label for="username">{{ 'register.lbl.email' | translate }}</label>
            <input type="email" class="form-control" name="username" [(ngModel)]="user.email" #username="ngModel" required pattern="[^@\s]+@[^@\s]+\.[^@\s]+" required autocomplete="on">
            <div *ngIf="f.submitted && !username.valid" class="help-block">{{ 'register.msg.emailRequired' | translate }}</div>
          </div>
        </div>
        <div class="form-group" [ngClass]="{ 'has-error': f.submitted && !password.valid }">
            <label for="password-new" data-toggle="tooltip" data-placement="top" data-delay='50'
              title="Password Rule: {{PWPolicyDescription}}">
              {{ 'register.lbl.password' | translate }} (*)
            </label>
            <input type="password" class="form-control" name="password-new" [(ngModel)]="user.password" #password="ngModel" required autocomplete="off" pattern= {{PWPolicy}} >
            <div *ngIf="!password.valid" class="help-block">{{ 'register.msg.followPolicy' | translate }}</div>
            <div *ngIf="!password.valid && PWPolicyDescription" class="help-block">{{PWPolicyDescription}}</div>
        </div>
        <form name="legal" #fLegal="ngForm" novalidate>
          <div>{{ 'register.titleTC' | translate }}</div>
          <div class="custom-control custom-checkbox">
              <input type="checkbox" class="custom-control-input" id="IDcheckTOU" name="checkTOU" [(ngModel)]="check_TOU" #checkTOU="ngModel" required>
              <label class="custom-control-label" for="IDcheckTOU"></label>
              <a href="https://visbo.de/visbo-terms-conditions" target="_blank">{{ 'register.lbl.acceptTC' | translate }}</a>
          </div>
          <div class="custom-control custom-checkbox">
              <input type="checkbox" class="custom-control-input" id="IDcheckDP" name="checkDP" [(ngModel)]="check_DP" #checkDP="ngModel" required>
              <label class="custom-control-label" for="IDcheckDP"></label>
              <a href="https://visbo.de/visbo-data-protection" target="_blank">{{ 'register.lbl.acceptDP' | translate }}</a>
          </div>
        </form>
        <div class="form-group">
          <button type="submit" class="btn btn-primary">{{ 'register.btn.register' | translate }}</button>
          <img *ngIf="loading" src="data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA==" />
          <a [routerLink]="['/login']" class="btn btn-link">{{ 'register.btn.cancel' | translate }}</a>
        </div>
    </form>
</div>
